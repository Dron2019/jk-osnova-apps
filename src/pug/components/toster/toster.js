import gsap from 'gsap';
import BezierEasing from 'bezier-easing';

export default class MyToster {
  constructor(setting) {
    this.$wrap = setting.$wrap;
    this.$item = setting.$item;
    this.ease_0 = BezierEasing(0.34, 0.98, 0.43, 0.95);

    this.$body = document.querySelector('body');

    this.init();
  }

  /*  */
  createItem({ type, title, text }) {
    return `
      <div class="toast" data-toast-item="" data-toast-status="${type}">
        <div class="toast-logo-block">
          <div class="toast__logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="154" height="40" viewBox="0 0 154 40" fill="none">
              <path d="M37.3819 39.8886L39.2326 37.5955L37.5715 35.5883H38.9407L40.2498 37.2073V35.5883H41.4535V37.2073L42.7536 35.5883H44.1228L42.4616 37.5955L44.3214 39.8886H42.8739L41.4535 38.0529V39.8886H40.2498V38.0529L38.8204 39.8886H37.3819Z" fill="#DDDDDD"/>
              <path d="M46.6446 39.8886V35.5883H47.8483V38.1222L49.7954 35.5883H50.9329V39.8886H49.7292V37.3548L47.7821 39.8886H46.6446Z" fill="#DDDDDD"/>
              <path d="M54.6404 39.8886V36.6055H53.2982V35.5883H57.2103V36.6055H55.8501V39.8886H54.6404Z" fill="#DDDDDD"/>
              <path d="M61.0894 36.6055L61.0713 37.2074C61.0706 37.7152 61.0048 38.2209 60.8757 38.712C60.6681 39.4373 60.2528 39.8917 59.4011 39.9158C59.2447 39.9251 59.0882 39.8983 58.9437 39.8375V38.8474C59.0241 38.8744 59.1087 38.8867 59.1935 38.8836C59.4794 38.8836 59.6599 38.718 59.7532 38.3298C59.8629 37.8443 59.9094 37.3467 59.8917 36.8492L59.9188 35.5823H63.6172V39.8827H62.4135V36.6055H61.0894Z" fill="#DDDDDD"/>
              <path d="M66.8282 36.133C67.2991 35.7107 67.9094 35.4771 68.542 35.4771C69.1745 35.4771 69.7848 35.7107 70.2558 36.133C70.4685 36.3437 70.6374 36.5944 70.7526 36.8708C70.8679 37.1471 70.9272 37.4436 70.9272 37.743C70.9272 38.0424 70.8679 38.3388 70.7526 38.6152C70.6374 38.8915 70.4685 39.1423 70.2558 39.353C69.7822 39.7698 69.1729 39.9997 68.542 39.9997C67.9111 39.9997 67.3018 39.7698 66.8282 39.353C66.6093 39.1449 66.4363 38.8934 66.3202 38.6146C66.2042 38.3358 66.1476 38.0359 66.1541 37.734C66.1477 37.4347 66.2044 37.1375 66.3205 36.8617C66.4367 36.5858 66.6097 36.3375 66.8282 36.133ZM68.5405 38.9407C68.6993 38.9464 68.8575 38.9186 69.0047 38.8589C69.152 38.7993 69.2851 38.7092 69.3951 38.5946C69.5047 38.4802 69.5906 38.3453 69.6479 38.1976C69.7052 38.0499 69.7328 37.8923 69.7292 37.734C69.7345 37.5767 69.7077 37.42 69.6502 37.2736C69.5928 37.1271 69.506 36.9939 69.3951 36.8823C69.1666 36.6604 68.8605 36.5363 68.542 36.5363C68.2234 36.5363 67.9174 36.6604 67.6888 36.8823C67.577 36.9934 67.4893 37.1264 67.4313 37.2729C67.3733 37.4195 67.3462 37.5764 67.3518 37.734C67.3473 37.8927 67.3748 38.0507 67.4327 38.1986C67.4906 38.3464 67.5777 38.4811 67.6888 38.5946C67.7982 38.7093 67.9307 38.7994 68.0775 38.8591C68.2243 38.9188 68.3821 38.9466 68.5405 38.9407Z" fill="#DDDDDD"/>
              <path d="M73.4577 39.8886V35.5883H75.8862C76.789 35.5883 77.2645 36.0638 77.2645 36.6927C77.2763 36.8781 77.2329 37.0629 77.1397 37.2236C77.0465 37.3843 76.9077 37.5137 76.7409 37.5955C76.9824 37.6584 77.1952 37.8019 77.344 38.0022C77.4929 38.2025 77.5689 38.4476 77.5594 38.6969C77.5594 39.4222 76.9907 39.8796 75.9916 39.8796L73.4577 39.8886ZM74.6614 37.3036H75.5071C75.8923 37.3036 76.0818 37.1562 76.0818 36.8643C76.0818 36.5724 75.8923 36.4249 75.5071 36.4249H74.6614V37.3036ZM74.6614 39.034H75.6966C76.118 39.034 76.3256 38.8715 76.3256 38.5525C76.3256 38.2335 76.118 38.071 75.6966 38.071H74.6614V39.034Z" fill="#DDDDDD"/>
              <path d="M80.1324 39.8886V35.5883H81.3362V38.1222L83.2832 35.5883H84.4207V39.8886H83.217V37.3548L81.27 39.8886H80.1324Z" fill="#DDDDDD"/>
              <path d="M87.2374 39.8886V35.5883H88.4412V38.1222L90.3882 35.5883H91.5257V39.8886H90.322V37.3548L88.375 39.8886H87.2374ZM87.8152 33.6413H88.718C88.718 33.8105 88.7852 33.9728 88.9049 34.0924C89.0245 34.212 89.1868 34.2793 89.356 34.2793C89.5252 34.2793 89.6875 34.212 89.8071 34.0924C89.9267 33.9728 89.994 33.8105 89.994 33.6413H90.9148C90.922 33.8423 90.8859 34.0425 90.8091 34.2283C90.7323 34.4142 90.6164 34.5814 90.4694 34.7186C90.166 34.9879 89.7705 35.1302 89.365 35.1159C88.4743 35.1159 87.8242 34.5471 87.8152 33.6413Z" fill="#DDDDDD"/>
              <path d="M102.016 39.8886V35.5883H103.22V37.1562L104.701 35.5883H106.19L104.321 37.5263L106.482 39.8886H104.935L103.241 38.0349V39.8886H102.016Z" fill="#DDDDDD"/>
              <path d="M108.881 36.133C109.351 35.7107 109.962 35.4771 110.594 35.4771C111.227 35.4771 111.837 35.7107 112.308 36.133C112.522 36.3433 112.691 36.5939 112.807 36.8703C112.923 37.1467 112.982 37.4433 112.982 37.743C112.982 38.0426 112.923 38.3393 112.807 38.6157C112.691 38.8921 112.522 39.1427 112.308 39.353C111.835 39.7698 111.225 39.9997 110.594 39.9997C109.963 39.9997 109.354 39.7698 108.881 39.353C108.662 39.1447 108.49 38.8931 108.374 38.6143C108.258 38.3355 108.202 38.0357 108.209 37.734C108.202 37.4349 108.259 37.1378 108.374 36.8619C108.49 36.5861 108.662 36.3377 108.881 36.133ZM110.596 38.9407C110.754 38.9466 110.912 38.9188 111.059 38.8591C111.206 38.7994 111.338 38.7093 111.447 38.5946C111.558 38.4804 111.644 38.3456 111.702 38.1979C111.76 38.0502 111.788 37.8925 111.785 37.734C111.789 37.5765 111.762 37.4198 111.704 37.2733C111.646 37.1269 111.559 36.9938 111.447 36.8823C111.219 36.6604 110.913 36.5363 110.594 36.5363C110.276 36.5363 109.97 36.6604 109.741 36.8823C109.63 36.9939 109.544 37.1271 109.486 37.2736C109.429 37.42 109.402 37.5767 109.407 37.734C109.403 37.8923 109.431 38.0499 109.488 38.1976C109.546 38.3453 109.632 38.4802 109.741 38.5946C109.851 38.7092 109.984 38.7993 110.132 38.8589C110.279 38.9186 110.437 38.9464 110.596 38.9407Z" fill="#DDDDDD"/>
              <path d="M115.513 39.8886V35.5883H116.717L117.969 37.1923L119.227 35.5883H120.43V39.8886H119.287V37.2344L118.219 38.5706H117.734L116.675 37.2344V39.8886H115.513Z" fill="#DDDDDD"/>
              <path d="M123.238 39.8886V35.5883H127.379V39.8886H126.175V36.6055H124.46V39.8886H123.238Z" fill="#DDDDDD"/>
              <path d="M131.926 36.6055L131.911 37.2074C131.908 37.7152 131.841 38.2207 131.712 38.712C131.505 39.4373 131.092 39.8917 130.238 39.9158C130.082 39.9251 129.927 39.8984 129.783 39.8375V38.8474C129.864 38.8749 129.948 38.8871 130.033 38.8836C130.316 38.8836 130.497 38.718 130.593 38.3298C130.701 37.8442 130.747 37.3465 130.728 36.8492L130.755 35.5823H134.469V39.8827H133.265V36.6055H131.926Z" fill="#DDDDDD"/>
              <path d="M137.698 39.3802C137.47 39.1723 137.291 38.9174 137.172 38.6331C137.053 38.3488 136.997 38.042 137.009 37.7341C137 37.4393 137.051 37.1459 137.157 36.871C137.264 36.596 137.424 36.3452 137.629 36.1331C137.836 35.9143 138.088 35.7425 138.367 35.6293C138.646 35.5162 138.947 35.4642 139.248 35.4771C139.53 35.4657 139.811 35.5195 140.07 35.6343C140.328 35.7491 140.556 35.9218 140.737 36.1391C141.115 36.5903 141.314 37.1641 141.297 37.7521V38.0711H138.212C138.342 38.6549 138.896 38.9739 139.651 38.9739C140.136 38.9716 140.611 38.8408 141.029 38.5947V39.5697C140.547 39.8901 139.973 40.0444 139.395 40.0091C138.77 40.0251 138.162 39.7999 137.698 39.3802ZM140.105 37.2947C140.104 37.1785 140.079 37.0638 140.033 36.9573C139.986 36.8509 139.919 36.7547 139.835 36.6745C139.751 36.5944 139.652 36.5318 139.543 36.4905C139.434 36.4492 139.319 36.43 139.203 36.434C138.959 36.4215 138.72 36.5043 138.536 36.665C138.352 36.8256 138.239 37.0515 138.219 37.2947H140.105Z" fill="#DDDDDD"/>
              <path d="M143.864 39.8886V35.5883H145.068V37.1562L146.551 35.5883H148.056L146.187 37.5263L148.348 39.8886H146.78L145.083 38.0349V39.8886H143.864Z" fill="#DDDDDD"/>
              <path d="M150.734 39.38C150.508 39.1694 150.329 38.9127 150.21 38.6272C150.091 38.3417 150.035 38.034 150.045 37.7249C150.033 37.4196 150.089 37.1154 150.208 36.834C150.327 36.5526 150.507 36.3009 150.734 36.0968C151.191 35.687 151.785 35.4655 152.398 35.4769C152.84 35.4697 153.277 35.5666 153.674 35.7598V36.795C153.332 36.6307 152.959 36.5424 152.579 36.5362C152.229 36.5252 151.888 36.6454 151.622 36.8733C151.501 36.9827 151.405 37.1162 151.339 37.2652C151.273 37.4143 151.238 37.5754 151.238 37.7384C151.238 37.9014 151.273 38.0626 151.339 38.2116C151.405 38.3606 151.501 38.4942 151.622 38.6036C151.886 38.8306 152.225 38.9508 152.573 38.9407C152.98 38.9484 153.382 38.8443 153.735 38.6397V39.6749C153.315 39.8927 152.847 40.0024 152.374 39.9939C151.769 40.0054 151.183 39.7859 150.734 39.38Z" fill="#DDDDDD"/>
              <path d="M31.1556 0V12.7716H28.5676V2.58802H18.39V0H31.1556Z" fill="#DDDDDD"/>
              <path d="M28.5676 26.8913H31.1556V39.6659H18.39V37.0779H28.5676V26.8913Z" fill="#DDDDDD"/>
              <path d="M12.7656 0V2.58802H2.58802V12.7716H0V0H12.7656Z" fill="#DDDDDD"/>
              <path d="M2.58802 37.0779H12.7656V39.6659H0V26.8913H2.58802V37.0779Z" fill="#DDDDDD"/>
              <path d="M15.8562 9.97597C9.53656 9.97597 5.38971 13.7587 5.38971 19.672C5.38971 25.5854 9.53957 29.4915 15.8562 29.4915C22.1727 29.4915 26.3587 25.3777 26.3587 19.6871C26.3587 13.9964 22.2088 9.97597 15.8562 9.97597ZM20.8426 24.6946C17.5785 23.9132 14.176 23.9132 10.9118 24.6946C11.3078 23.0683 11.5049 21.4 11.4986 19.7262C11.5039 18.0481 11.3048 16.3757 10.9058 14.7458C12.5315 15.1468 14.1998 15.3489 15.8742 15.3476C17.5486 15.3489 19.217 15.1468 20.8426 14.7458C20.0612 18.0099 20.0612 21.4124 20.8426 24.6765V24.6946Z" fill="#FFBC64"/>
              <path d="M92.5098 9.90976C86.1902 9.90976 82.0464 13.6925 82.0464 19.6058C82.0464 25.5191 86.1962 29.4102 92.5098 29.4102C98.8234 29.4102 103.015 25.2965 103.015 19.6058C103.015 13.9152 98.8655 9.90976 92.5098 9.90976ZM97.5023 24.6284C94.2381 23.8474 90.8357 23.8474 87.5715 24.6284C88.3569 21.3647 88.3569 17.9613 87.5715 14.6976C89.1982 15.0985 90.8675 15.3006 92.5429 15.2995C94.2173 15.3006 95.8856 15.0985 97.5113 14.6976C96.7259 17.9613 96.7259 21.3647 97.5113 24.6284H97.5023Z" fill="#FFBC64"/>
              <path d="M42.8107 29.4914C36.5061 29.4914 33.5389 25.7538 33.5389 22.6753H38.0529C38.0529 23.6292 39.8585 25.2783 43.2922 25.2783C46.0758 25.2783 46.9936 24.2883 46.9936 23.2621C46.9936 19.6719 33.6924 22.0583 33.6924 15.4559C33.6924 12.6 36.4399 10.0391 42.2299 10.0391C48.709 10.0391 51.1586 13.241 51.1586 15.7929H46.6446C46.6446 14.6193 44.9232 13.7044 41.956 13.7044C39.9398 13.7044 38.1793 14.2521 38.1793 15.4258C38.1793 18.065 51.5558 15.5371 51.5558 22.9762C51.5678 26.5302 48.7812 29.4914 42.8107 29.4914Z" fill="#FFBC64"/>
              <path d="M69.7141 10.5597C73.4517 10.5597 76.3346 12.6873 76.3346 16.8643V29.4312H71.8206V20.1023C71.8206 16.5844 70.5387 15.0105 67.8634 15.0105C64.9323 15.0105 62.4466 16.5844 62.4466 20.1023V29.4312H57.9868V11.1104H62.4586V11.4114C62.4586 12.8769 61.7243 14.6374 61.1766 16.0307L61.944 16.3587C62.4947 14.9684 63.0063 12.9883 64.18 12.0734C65.7207 10.8547 67.3307 10.5597 69.7141 10.5597Z" fill="#FFBC64"/>
              <path d="M116.958 21.9049C117.508 23.1869 117.472 25.0196 117.472 26.4189H118.315C118.315 24.9895 118.24 23.1929 118.79 21.9049L123.443 11.1345H128.354L120.292 29.4553H115.639L107.433 11.1345H112.308L116.958 21.9049Z" fill="#FFBC64"/>
              <path d="M142.302 29.5185C136.843 29.5185 132.994 25.1219 132.994 19.663C132.994 14.204 136.843 10.0602 142.302 10.0602C144.758 10.0602 146.663 10.9028 147.984 12.3322C148.751 13.1387 148.887 14.6404 149.266 15.7057L150.033 15.4469C149.705 14.3846 149.046 13.1026 149.046 12.0042L149.007 10.6109H153.521V28.9317H149.007L149.046 27.427C149.046 26.3286 149.705 25.0196 150.033 23.9814L149.227 23.7256C148.899 24.7517 148.751 26.2534 148.023 27.099C146.663 28.6037 144.749 29.5185 142.302 29.5185ZM142.558 25.3416C145.567 25.3416 147.58 22.6663 147.674 19.663C147.674 16.437 145.868 14.2462 142.558 14.2462C139.518 14.2462 137.502 16.5573 137.502 19.663C137.502 22.7686 139.518 25.3416 142.558 25.3416Z" fill="#FFBC64"/>
            </svg>
          </div>
        </div>
        <div class="toast-content-block">
          <h5 class="toast__title">${title}</h5>
          <p class="toast__text">${text}</p>
        </div>
        <button class="toast__colose-btn" data-toast-colose-btn="" type="button">
          <svg class="icon--close" role="presentation">
            <use xlink:href="#icon-close"></use>
          </svg>
        </button>
      </div>
    `;
  }

  removeItem(item) {
    gsap.fromTo(
      item,
      0.25,
      { xPercent: 0, ease: this.ease_0 },
      {
        xPercent: 100,
        onComplete: () => {
          item.remove();
        },
      },
    );
  }

  addToast(settingObj) {
    const markup = this.createItem(settingObj);
    this.$wrap.insertAdjacentHTML('beforeend', markup);
    /*  */
    const items = this.$wrap.querySelectorAll('[data-toast-item]');
    const item = items[items.length - 1];
    /*  */
    gsap.fromTo(
      item,
      0.75,
      { xPercent: 100, skewX: -10 },
      { xPercent: 0, skewX: 0, ease: this.ease_0 },
    );

    setTimeout(() => {
      this.removeItem(item);
    }, 3000);
  }

  listeners() {
    const self = this;
    if (!this.$wrap) return;
    this.$wrap.addEventListener('click', ({ target }) => {
      if (target.closest('[data-toast-colose-btn]') !== null) {
        const item = target.closest('[data-toast-item]');
        self.removeItem(item);
      }
    });
  }

  init() {
    this.listeners();
  }
}
